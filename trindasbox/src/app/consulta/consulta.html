<div class="consultas-container">
  <div class="overlay"></div>

  <div class="form-wrapper">
    <h2>Consultar</h2>

    <select id="tipoConsulta" [(ngModel)]="tipoConsultaSelecionado">
      <option value disabled selected>Selecione</option>
      <option value="alimentoPorId">Alimento por ID</option>
      <option value="produtoPorId">Produto por ID</option>
      <option value="usuarioPorCracha">Usuário por Crachá</option>
      <option value="usuarios">Usuários com divida</option>
      <option value="produtos">Todos os Produtos Religiosos</option>
      <option value="alimentos">Todos os Alimentos</option>
      <option value="vendas">Todas as vendas</option>

    </select>

    <!-- Consulta por crachá -->
    <div *ngIf="tipoConsultaSelecionado === 'usuarioPorCracha'">
      <input style='width: 100%;' [(ngModel)]="numeroCracha" type="number"
        placeholder="Número do Crachá" />
    </div>

    <!-- Consulta por ID de alimento -->
    <div *ngIf="tipoConsultaSelecionado === 'alimentoPorId'">
      <input style='width: 100%;' [(ngModel)]="idAlimento" type="text"
        placeholder="ID do Alimento" />
    </div>

    <!-- Consulta por ID de produto -->
    <div *ngIf="tipoConsultaSelecionado === 'produtoPorId'">
      <input style='width: 100%;' [(ngModel)]="idProduto" type="text"
        placeholder="ID do produto" />
    </div>

    <div class="resultado" *ngIf="resultado">
  <!-- Se for um array de objetos -->
  <div class="tabela-wrapper" *ngIf="isArray(resultado) && resultado.length > 0">
    <table>
      <thead>
        <tr>
          <th *ngFor="let key of getKeys(resultado[0])">{{ key }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of resultado">
          <td *ngFor="let key of getKeys(item)">{{ item[key] }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Se for objeto único -->
  <div class="tabela-wrapper" *ngIf="!isArray(resultado) && isObject(resultado)">
    <table>
      <tbody>
        <tr *ngFor="let key of getKeys(resultado)">
          <th>{{ key }}</th>
          <td>{{ resultado[key] }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Se não for objeto nem array (ex: string, null) -->
  <div *ngIf="!isObject(resultado) && !isArray(resultado)">
    <pre>{{ resultado }}</pre>
  </div>
</div>


    <div class="botoes">
      <button routerLink="/" class="voltar-btn">Voltar</button>
      <button class="confirmar-btn" type="submit"
        *ngIf="tipoConsultaSelecionado === 'usuarioPorCracha'"
        (click)="buscarUsuarioPorCracha()">Buscar</button>
      <button class="confirmar-btn" type="submit"
        *ngIf="tipoConsultaSelecionado === 'alimentoPorId'"
        (click)="buscarAlimentoPorId()">Buscar</button>
      <button class="confirmar-btn" type="submit"
        *ngIf="tipoConsultaSelecionado === 'produtoPorId'"
        (click)="buscarProdutoPorId()">Buscar</button>
      <button class="confirmar-btn" type="submit"
        *ngIf="tipoConsultaSelecionado === 'usuarios' || tipoConsultaSelecionado === 'produtos' || tipoConsultaSelecionado === 'alimentos' || tipoConsultaSelecionado === 'vendas'"
        (click)="consultarTodos()">Buscar Todos</button>
    </div>

  </div>
</div>
